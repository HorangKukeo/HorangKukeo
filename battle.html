<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>문법 RPG - 전투</title>
    <link rel="stylesheet" href="battlestyle.css">
</head>
<body>
    <div id="game-container">
        <!-- 🎯 새로운 기능: 턴 표시 배너 -->
        <div id="turn-indicator" class="player-turn">
            🗡️ 당신의 턴입니다
        </div>

        <!-- 🎯 새로운 기능: 진행도 표시 -->
        <div id="progress-bar-container">
            <div id="progress-info">
                <span>던전 진행도</span>
                <span id="progress-text">몬스터 1 / 5</span>
            </div>
            <div id="progress-bar-track">
                <div id="progress-bar-fill" style="width: 0%"></div>
            </div>
        </div>

        <div class="character-box" id="monster-box">
            <div class="character-info">
                <h2 id="monster-name"></h2>
                <div class="hp-bar-container">
                    <div class="bar-background">
                        <div id="monster-hp-bar" class="bar hp"></div>
                        <span class="bar-text" id="monster-hp-text"></span>
                    </div>
                    <!-- ✅ 개선: 우측 텍스트 제거 -->
                </div>
            </div>
            <div class="character-img-container">
                <img id="monster-image" src="img/slime-idle.png" alt="몬스터">
            </div>
        </div>

        <div class="character-box" id="player-box">
             <div class="character-img-container">
                <img id="player-image" src="img/oldimg/player0.png" alt="플레이어">
            </div>
            <div class="character-info">
                <div class="player-header">
                    <h2 id="player-name">용사</h2>
                    <button id="info-btn">내 정보</button>
                </div>
                <div class="hp-bar-container">
                    <span class="stat-label">HP:</span>
                    <div class="bar-background">
                        <div id="player-hp-bar" class="bar hp"></div>
                        <span class="bar-text" id="player-hp-text"></span>
                    </div>
                    <!-- ✅ 개선: 우측 텍스트 제거 -->
                </div>
                <div class="hp-bar-container">
                    <span class="stat-label">MP:</span>
                    <div class="bar-background">
                        <div id="player-mp-bar" class="bar mp"></div>
                        <span class="bar-text" id="player-mp-text"></span>
                    </div>
                    <!-- ✅ 개선: 우측 텍스트 제거 -->
                </div>
                <div id="equipped-cards">
                    <div class="card-slot"></div>
                    <div class="card-slot"></div>
                    <div class="card-slot"></div>
                    <div class="card-slot"></div>
                </div>
            </div>
        </div>

        <div id="ui-area">
            <!-- 🎯 새로운 기능: 전투 로그 -->
            <div id="battle-log">
                <div class="log-entry">⚔️ 전투가 시작되었습니다!</div>
            </div>

            <div id="message-box" class="box"><p id="message-text"></p></div>
                <div id="quiz-box" class="box hidden">
                    <p id="quiz-text-prompt"></p>
                        <div id="quiz-text-context"></div>
                        <div id="quiz-answers"></div>
                    
                    <div id="quiz-answers"></div>

                    <div id="quiz-short-answer-area" class="hidden">
                        <input type="text" id="short-answer-input" placeholder="정답을 입력하세요...">
                        <button id="short-answer-submit-btn" class="quiz-btn">제출</button>
                    </div>
                </div>
        </div>
        
        <div id="action-menu" class="box">
            <button class="action-btn" data-action="attack">공격</button>
            <button class="action-btn" data-action="skill">스킬</button>
            <button class="action-btn" data-action="item">아이템</button>
            <button class="action-btn" data-action="flee">도망가기</button>
        </div>
    </div>

    <div id="modal-backdrop" class="hidden">
        <div id="skill-modal" class="modal-window hidden">
            <h3>스킬 선택</h3><div id="skill-list"></div><button class="modal-close-btn">닫기</button>
        </div>
        <div id="item-modal" class="modal-window hidden">
            <h3>아이템 선택</h3><div id="item-list"></div><button class="modal-close-btn">닫기</button>
        </div>
        <div id="victory-modal" class="modal-window hidden">
            <h3>전투 승리!</h3><p id="victory-message"></p><button id="continue-battle-btn">계속하기</button>
        </div>
        <div id="info-modal" class="modal-window hidden">
            <h3>내 정보</h3><div id="info-list"></div><button class="modal-close-btn">닫기</button>
        </div>
    </div>

    <!-- ✅ 오류 수정: modal 클래스 구조 유지 -->
    <div id="game-over" class="modal hidden">
        <div class="modal-window" style="text-align: center;">
            <h2 style="color: #c74343; font-family: var(--font-pixel); font-size: 3em;">GAME OVER</h2>
            <p id="game-over-message" style="margin: 20px 0;"></p>
            <button id="return-to-main-from-gameover-btn" class="return-to-main-btn" style="background-color: #7c3c7c; border-color: #b981b9;">메인 화면으로 돌아가기</button>
        </div>
    </div>

    <div id="dungeon-clear" class="modal hidden">
        <div class="modal-window" style="width: auto;">
            <h2>던전 클리어!</h2>
            <p>이번 탐험에서 획득한 보상입니다.</p>
            <div id="final-rewards"></div>
            <button id="return-to-main-btn">메인 화면으로 돌아가기</button>
        </div>
    </div>

    <audio id="bgm-battle" src="music/battle-theme.mp3" loop></audio>

    <script src="js/common.js"></script>
    <script src="js/battle.js"></script>
</body>
</html>