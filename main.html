<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>문법 RPG - 메인</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div class="main-container">
        <div id="player-status-container">
            <div class="player-portrait">
                <img src="img/oldimg/player0.png" alt="Player Portrait">
            </div>
            <div class="player-info">
                <h2 id="user-nickname"></h2>
                <div class="status-bar">
                    <span class="label">HP</span>
                    <div class="bar-background">
                        <div id="player-hp-bar" class="bar hp">
                            <span id="player-hp-value" class="bar-value"></span>
                            <small id="player-hp-details" class="bar-details"></small>
                            </div>
                    </div>
                    </div>
                <div class="status-bar">
                    <span class="label">MP</span>
                    <div class="bar-background">
                        <div id="player-mp-bar" class="bar mp">
                            <span id="player-mp-value" class="bar-value"></span>
                            <small id="player-mp-details" class="bar-details"></small>
                            </div>
                    </div>
                    </div>
                <div class="status-bar">
                    <span class="label">ATK</span>
                    <div class="bar-background">
                        <div id="player-attack-bar" class="bar attack">
                            <span id="player-attack-value" class="bar-value"></span>
                            <small id="player-attack-details" class="bar-details"></small>
                        </div>
                    </div>
                </div>
                <div class="stats-grid">
                    <p>🎴 보유 카드: <span id="user-card-count"></span> 장</p>
                    <p>💰 골드: <span id="user-gold"></span> G</p>
                    <p>🅿️ 품사 포인트: <span id="user-pos-points"></span> P</p>
                    <p>📑 문장 성분 포인트: <span id="user-sc-points"></span> P</p>
                </div>
                <div class="player-actions">
                    <button id="card-view-btn" class="view-btn">카드 보기</button>
                    <button id="item-view-btn" class="view-btn">아이템 보기</button>
                </div>
            </div>
        </div>

        <div id="main-content-container">
            <p id="loading-message">게임 데이터를 불러오는 중...</p>
            <div id="main-menu" class="hidden">
                <button id="explore-btn" class="main-menu-btn">🗺️ 탐험하기</button>
                <button id="goals-btn" class="main-menu-btn">🎯 성장 목표</button>
                <button id="shop-btn" class="main-menu-btn">🛍️ 상점</button>
                <button id="gacha-btn" class="main-menu-btn">✨ 카드 뽑기</button>
            </div>
        </div>

    <div id="modal-backdrop" class="hidden">

        <div id="growth-goals-modal" class="modal-window hidden">
            <h3>🎯 성장 목표</h3>
            <p>현재 달성 수: <span id="goals-achieved-count">0</span> / 18</p>
            <div id="goal-list">
                </div>
            <button class="modal-close-btn">닫기</button>
        </div>

        <div id="card-dex-modal" class="modal-window hidden">
            <h3>🎴 카드 보기</h3>
            
            <div class="card-section">
                <h4>장착한 카드 (최대 4개)</h4>
                <div id="equipped-cards-section" class="card-grid">
                    </div>
            </div>

            <div class="card-section">
                <h4>카드 도감</h4>
                <div class="dex-content-wrapper">
                    <div id="dex-filter-buttons">
                        <button class="dex-filter-btn active" data-range="1-10">1-10</button>
                        <button class="dex-filter-btn" data-range="11-20">11-20</button>
                        <button class="dex-filter-btn" data-range="21-30">21-30</button>
                        <button class="dex-filter-btn" data-range="31-40">31-40</button>
                    </div>
                    <div id="card-dex-section" class="card-grid dex">
                        </div>
                </div>
            </div>

            <button class="modal-close-btn">닫기</button>
        </div>

        <div id="card-detail-modal" class="modal-window hidden">
            <h3 id="detail-card-name"></h3>
            <div id="detail-card-content">
                </div>
            <button id="detail-modal-close-btn">닫기</button>
        </div>
        
        <div id="item-view-modal" class="modal-window hidden">
            <h3>소유 아이템</h3>
            <div id="item-view-list" class="item-list"></div>
            <button class="modal-close-btn">닫기</button>
        </div>

        <div id="dungeon-modal" class="modal-window hidden">
            <h3>탐험할 던전을 선택하세요</h3>
            
            <div id="dungeon-category-list"></div>
            <div id="dungeon-list"></div>
            <button class="modal-close-btn">닫기</button>
        </div>

        <div id="shop-modal" class="modal-window hidden">
            <h3>🛍️ 상점</h3>
            <p>보유 골드: <span id="shop-user-gold"></span> G</p>
            <div id="shop-item-list" class="item-list">
                </div>
            <button class="modal-close-btn">닫기</button>
        </div>
        <div id="gacha-modal" class="modal-window hidden">
            <h3>✨ 카드 뽑기</h3>
            <div id="gacha-category-list"></div>
            <div id="gacha-pack-list">
                </div>
            <div id="gacha-result-view" class="hidden" style="text-align: center;">
                <h4>🎉 축하합니다! 🎉</h4>
                <p>아래 카드를 획득했습니다!</p>
                <div id="gacha-result-card" style="border: 2px solid var(--accent-color); padding: 20px; margin: 10px auto; width: 200px; border-radius: 10px;">
                    </div>
                <button id="gacha-confirm-btn">확인</button>
            </div>
            <button class="modal-close-btn">닫기</button>
        </div>
    </div>
    <div id="battle-mode-container"></div>

    <audio id="bgm-main" src="music/main-theme.mp3" loop></audio>
    <script>
        document.body.addEventListener('click', function playMusic() {
            // [수정] id를 "bgm-main"으로 변경
            const bgm = document.getElementById('bgm-main');
            bgm.volume = 0.4;
            bgm.play();
            document.body.removeEventListener('click', playMusic);
        });
    </script>

    <script src="js/common.js"></script>
    <script src="js/main.js"></script>
</body>
</html>