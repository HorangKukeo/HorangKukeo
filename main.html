<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>문법 RPG - 메인</title>
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="tuto.css">
</head>
<body>
    <h3 class="main-title">호랑국어 신성식의 문법 RPG</h3>
    <div class="main-container">
        <div id="player-status-container">
            <div class="player-portrait">
                <img src="img/player0.png" alt="Player Portrait">
            </div>
            <div class="player-info">
                <h2 id="user-nickname"></h2>
                <div class="status-bar">
                    <span class="label">HP</span>
                    <div class="bar-background">
                        <div id="player-hp-bar" class="bar hp">
                            <span id="player-hp-value" class="bar-value"></span>
                            <small id="player-hp-details" class="bar-details"></small>
                            </div>
                    </div>
                    </div>
                <div class="status-bar">
                    <span class="label">MP</span>
                    <div class="bar-background">
                        <div id="player-mp-bar" class="bar mp">
                            <span id="player-mp-value" class="bar-value"></span>
                            <small id="player-mp-details" class="bar-details"></small>
                            </div>
                    </div>
                    </div>
                <div class="status-bar">
                    <span class="label">ATK</span>
                    <div class="bar-background">
                        <div id="player-attack-bar" class="bar attack">
                            <span id="player-attack-value" class="bar-value"></span>
                            <small id="player-attack-details" class="bar-details"></small>
                        </div>
                    </div>
                </div>
                <div class="stats-grid">
                    <p>🎴 보유 카드: <span id="user-card-count"></span> 장</p>
                    <p>💰 골드: <span id="user-gold"></span> G</p>
                    <p>🅿️ 품사 포인트: <span id="user-pos-points"></span> P</p>
                    <p>📑 문장 성분 포인트: <span id="user-sc-points"></span> P</p>
                </div>
                <div class="player-actions">
                    <button id="card-view-btn" class="view-btn">카드 보기</button>
                    <button id="item-view-btn" class="view-btn">아이템 보기</button>
                </div>
            </div>
        </div>

        <div id="main-content-container">
            <p id="loading-message">게임 데이터를 불러오는 중...</p>
            <div id="main-menu" class="hidden">
                <button id="explore-btn" class="main-menu-btn">🗺️ 탐험하기</button>
                <button id="goals-btn" class="main-menu-btn">🎯 성장 목표</button>
                <button id="shop-btn" class="main-menu-btn">🛍️ 상점</button>
                <button id="gacha-btn" class="main-menu-btn">✨ 카드 뽑기</button>
                <div class="button-row">
                    <button id="guidebook-btn" class="main-menu-btn half-width">📚 가이드북</button>
                    <button id="tutorial-btn" class="main-menu-btn half-width">⚔️ 튜토리얼</button>
                </div>
            </div>
        </div>

    <div id="modal-backdrop" class="hidden">

        <div id="tutorial-prompt-modal" class="modal-window hidden" style="max-width: 400px; text-align: center;">
            <h3>⚔️ 문법 RPG 튜토리얼</h3>
            <p style="margin: 20px 0; font-size: 1.1em;">
                문법 RPG에 오신 것을 환영합니다!
                <br>
                게임의 기본 진행 방법을 알아보시겠습니까?
            </p>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px;">
                <button id="tutorial-skip-btn" class="tutorial-prompt-btn" style="background-color: #777;">다음에 하기</button>
                <button id="tutorial-start-btn" class="tutorial-prompt-btn" style="background-color: var(--hp-color);">진행하기</button>
            </div>
        </div>

        <div id="tutorial-complete-modal" class="modal-window hidden" style="max-width: 400px; text-align: center;">
            <h3>🎉 튜토리얼 완료!</h3>
            <p style="margin: 20px 0; font-size: 1.1em;">
                축하합니다! 튜토리얼을 모두 완료했습니다!
                <br><br>
                튜토리얼 때 사용한 카드와 아이템은 모두 사라집니다.
                <br><br>
                이제부터, '진짜' 게임을 시작하세요.
            </p>
            <button id="tutorial-complete-btn" class="tutorial-prompt-btn" style="background-color: var(--hp-color);">종료</button>
        </div>

        <div id="growth-goals-modal" class="modal-window hidden">
            <h3>🎯 성장 목표</h3>
            <p>현재 달성 수: <span id="goals-achieved-count">0</span> / 18</p>
            <div id="goal-list">
                </div>
            <button class="modal-close-btn">닫기</button>
        </div>

        <div id="card-dex-modal" class="modal-window hidden">
            <h3>🎴 카드 보기</h3>
            
            <div class="card-section">
                <h4>장착한 카드 (최대 4개)</h4>
                <div id="equipped-cards-section" class="card-grid">
                    </div>
            </div>

            <div class="card-section">
                <h4>카드 도감</h4>
                <div class="dex-content-wrapper">
                    <div id="dex-filter-buttons">
                        <button class="dex-filter-btn active" data-range="1-10">1-10</button>
                        <button class="dex-filter-btn" data-range="11-20">11-20</button>
                        <button class="dex-filter-btn" data-range="21-30">21-30</button>
                        <button class="dex-filter-btn" data-range="31-40">31-40</button>
                        <button class="dex-filter-btn" data-range="41-50">41-50</button>
                    </div>
                    <div id="card-dex-section" class="card-grid dex">
                        </div>
                </div>
            </div>

            <button class="modal-close-btn">닫기</button>
        </div>

        <div id="card-detail-modal" class="modal-window hidden">
            <div class="card-detail-header">
                <span id="card-detail-number" class="card-number">#XXX</span>
                <h3 id="card-detail-name" class="card-name">카드 이름</h3>
            </div>
            <div class="card-detail-content">
                <div id="card-detail-info" class="detail-section">
                    </div>
                <div id="card-detail-skill" class="detail-section">
                    </div>
                <div id="card-detail-desc" class="detail-section">
                    </div>
            </div>
            <button id="detail-modal-close-btn">닫기</button>
        </div>
        
        <div id="item-view-modal" class="modal-window hidden">
            <h3>소유 아이템</h3>
            <div id="item-view-list" class="item-list"></div>
            <button class="modal-close-btn">닫기</button>
        </div>

        <div id="dungeon-modal" class="modal-window hidden">
            <h3>탐험할 던전을 선택하세요</h3>
            
            <div id="dungeon-category-list"></div>
            <div id="dungeon-list"></div>
            <button class="modal-close-btn">닫기</button>
        </div>

        <div id="shop-modal" class="modal-window hidden">
            <h3>🛍️ 상점</h3>
            <p>보유 골드: <span id="shop-user-gold"></span> G</p>
            <div id="shop-item-list" class="item-list">
                </div>
            <button class="modal-close-btn">닫기</button>
        </div>
        <div id="gacha-modal" class="modal-window hidden">
            <h3>✨ 카드 뽑기</h3>
            <div id="gacha-category-list"></div>
            <div id="gacha-pack-list">
                </div>
            <div id="gacha-result-view" class="hidden" style="text-align: center;">
                <h4>🎉 축하합니다! 🎉</h4>
                <p>아래 카드를 획득했습니다!</p>
                <div id="gacha-result-card" style="border: 2px solid var(--accent-color); padding: 20px; margin: 10px auto; width: 200px; border-radius: 10px;">
                    </div>
                <button id="gacha-confirm-btn">확인</button>
            </div>
            <button class="modal-close-btn">닫기</button>
        </div>

        <div id="tutorial-modal" class="modal-window hidden" style="max-height: 80vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3>📚 문법 RPG 가이드북</h3>
                <span id="tutorial-progress" style="font-size: 0.9em; color: #999;">1/7</span>
            </div>
            
            <div id="tutorial-content">
                <!-- 콘텐츠 동적 삽입 -->
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: space-between;">
                <button id="tutorial-prev-btn" style="display: none;">← 이전</button>
                <button id="tutorial-close-btn" class="tutorial-close-btn">닫기</button>
                <button id="tutorial-next-btn">다음 →</button>
            </div>
        </div>
    </div>
    <div id="battle-mode-container"></div>

    <audio id="bgm-main" src="music/main-theme.mp3" loop></audio>
    <script>
        document.body.addEventListener('click', function playMusic() {
            // [수정] id를 "bgm-main"으로 변경
            const bgm = document.getElementById('bgm-main');
            bgm.volume = 0.5;
            bgm.play();
            document.body.removeEventListener('click', playMusic);
        });
    </script>

    <script src="js/common.js"></script>
    <script src="js/main.js"></script>
    <script src="js/tutorial.js"></script>
</body>
</html>